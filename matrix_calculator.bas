10 PRINT CHR$(147)
20 PRINT "***** MATRIX CALCULATOR *****"
30 PRINT "1=ADD  2=SUBTRACT  3=MULTIPLY  0=QUIT"

40 INPUT "SELECT OPERATION "; O
50 IF O = 0 THEN END
60 INPUT "NUMBER OF ROWS FOR MATRIX A: "; R1
70 INPUT "NUMBER OF COLUMNS FOR MATRIX A: "; C1
80 INPUT "NUMBER OF ROWS FOR MATRIX B: "; R2
90 INPUT "NUMBER OF COLUMNS FOR MATRIX B: "; C2

100 IF O = 3 AND C1 <> R2 THEN PRINT "ERROR: COLUMNS OF A MUST EQUAL ROWS OF B" : GOTO 40
110 DIM A(R1, C1), B(R2, C2), RES(10, 10)

120 PRINT "ENTER MATRIX A:"
130 FOR I = 0 TO R1 - 1
140   FOR J = 0 TO C1 - 1
150     PRINT "A(" ; I + 1 ; "," ; J + 1 ; ") ";
160     INPUT A(I, J)
170   NEXT J
180 NEXT I

190 PRINT "ENTER MATRIX B:"
200 FOR I = 0 TO R2 - 1
210   FOR J = 0 TO C2 - 1
220     PRINT "B(" ; I + 1 ; "," ; J + 1 ; ") ";
230     INPUT B(I, J)
240   NEXT J
250 NEXT I

260 REM DISPLAY INPUT MATRICES
270 PRINT
280 PRINT "MATRIX A:"
290 GOSUB 910
300 PRINT
310 PRINT "MATRIX B:"
320 GOSUB 920

330 IF O = 1 THEN GOSUB 500  ' ADDITION
340 IF O = 2 THEN GOSUB 600  ' SUBTRACTION
350 IF O = 3 THEN GOSUB 700  ' MULTIPLICATION
360 GOTO 40

500 REM MATRIX ADDITION
510 FOR I = 0 TO R1 - 1
520   FOR J = 0 TO C1 - 1
530     RES(I, J) = A(I, J) + B(I, J)
540   NEXT J
550 NEXT I
560 PRINT : PRINT "RESULT OF ADDITION:"
570 GOSUB 930
580 RETURN

600 REM MATRIX SUBTRACTION
610 FOR I = 0 TO R1 - 1
620   FOR J = 0 TO C1 - 1
630     RES(I, J) = A(I, J) - B(I, J)
640   NEXT J
650 NEXT I
660 PRINT : PRINT "RESULT OF SUBTRACTION:"
670 GOSUB 930
680 RETURN

700 REM MATRIX MULTIPLICATION
710 FOR I = 0 TO R1 - 1
720   FOR J = 0 TO C2 - 1
730     SUM = 0
740     FOR K = 0 TO C1 - 1
750       SUM = SUM + A(I, K) * B(K, J)
760     NEXT K
770     RES(I, J) = SUM
780   NEXT J
790 NEXT I
800 PRINT : PRINT "RESULT OF MULTIPLICATION:"
810 GOSUB 930
820 RETURN

910 REM DISPLAY MATRIX A
911 FOR I = 0 TO R1 - 1
912   FOR J = 0 TO C1 - 1
913     PRINT A(I, J); CHR$(9);
914   NEXT J
915   PRINT
916 NEXT I
917 RETURN

920 REM DISPLAY MATRIX B
921 FOR I = 0 TO R2 - 1
922   FOR J = 0 TO C2 - 1
923     PRINT B(I, J); CHR$(9);
924   NEXT J
925   PRINT
926 NEXT I
927 RETURN

930 REM DISPLAY RESULT MATRIX
931 FOR I = 0 TO R1 - 1
932   FOR J = 0 TO C2 - 1
933     PRINT RES(I, J); CHR$(9);
934   NEXT J
935   PRINT
936 NEXT I
937 RETURN